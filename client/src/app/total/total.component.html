<div class="p-4">
  <table class="w-full table-auto border-collapse border border-gray-300">
    <thead>
    <tr class="bg-gray-200">
      <th class="px-4 py-2 border">Category</th>
      <ng-container *ngFor="let groupedRevenue of revenues">
        <th class="px-4 py-2 border">
          {{ groupedRevenue.month }} {{ groupedRevenue.year }} (Planned)
        </th>
        <th class="px-4 py-2 border">
          {{ groupedRevenue.month }} {{ groupedRevenue.year }} (Actual)
        </th>
      </ng-container>
    </tr>
    </thead>

    <tbody>
    <ng-container *ngFor="let category of revenueCategories">
      <tr>
        <td class="px-4 py-2 border">{{ category }}</td>

        <ng-container *ngFor="let groupedRevenue of revenues">
          <td class="px-4 py-2 border">
            <ng-container
              *ngIf="
                      getRevenueForCategoryAndType(groupedRevenue, category, 'planned') as plannedRevenue;
                      else noPlannedRevenue
                    "
            >
              {{ plannedRevenue.amount }}
            </ng-container>
            <ng-template #noPlannedRevenue>0</ng-template>
          </td>

          <td class="px-4 py-2 border">
            <ng-container
              *ngIf="
                      getRevenueForCategoryAndType(groupedRevenue, category, 'actual') as actualRevenue;
                      else noActualRevenue
                    "
            >
              {{ actualRevenue.amount }}
            </ng-container>
            <ng-template #noActualRevenue>0</ng-template>
          </td>
        </ng-container>
      </tr>
    </ng-container>

    <tr class="bg-gray-100 font-bold">
      <td class="px-4 py-2 border">Revenue Total</td>
      <ng-container *ngFor="let groupedRevenue of revenues">
        <td class="px-4 py-2 border">
          {{ calculateTotalRevenue(groupedRevenue, 'planned') }}
        </td>
        <td class="px-4 py-2 border">
          {{ calculateTotalRevenue(groupedRevenue, 'actual') }}
        </td>
      </ng-container>
    </tr>

    <ng-container *ngFor="let category of categories">
      <tr>
        <td class="px-4 py-2 border">{{ category }}</td>

        <ng-container *ngFor="let groupedExpense of expenses">
          <td class="px-4 py-2 border">
            <ng-container
              *ngIf="
                    getExpenseForCategoryAndType(groupedExpense, category, 'planned') as plannedExpense;
                    else noPlannedExpense
                  "
            >
              {{ plannedExpense.amount }}
            </ng-container>
            <ng-template #noPlannedExpense>0</ng-template>
          </td>

          <td class="px-4 py-2 border">
            <ng-container
              *ngIf="
                    getExpenseForCategoryAndType(groupedExpense, category, 'actual') as actualExpense;
                    else noActualExpense
                  "
            >
              {{ actualExpense.amount }}
            </ng-container>
            <ng-template #noActualExpense>0</ng-template>
          </td>
        </ng-container>
      </tr>
    </ng-container>

    <tr class="bg-gray-100 font-bold">
      <td class="px-4 py-2 border">Expense Total</td>
      <ng-container *ngFor="let groupedExpense of expenses">
        <td class="px-4 py-2 border">
          {{ calculateTotalExpense(groupedExpense, 'planned') }}
        </td>
        <td class="px-4 py-2 border">
          {{ calculateTotalExpense(groupedExpense, 'actual') }}
        </td>
      </ng-container>
    </tr>
    </tbody>

    <tfoot>
    <tr class="bg-gray-200 font-bold">
      <td class="px-4 py-2 border">Overall Total</td>

      <ng-container *ngFor="let groupedRevenue of revenues">
        <td class="px-4 py-2 border">
          {{ calculateOverallBalanceForGrouped('planned', groupedRevenue) }}
        </td>
        <td class="px-4 py-2 border">
          {{ calculateOverallBalanceForGrouped('actual', groupedRevenue) }}
        </td>
      </ng-container>
    </tr>
    </tfoot>

  </table>
</div>
